# **USER FLOW DIAGRAMS -- MINI BANKING SYSTEM**

**Version:** 1.0  
**Date:** 2025-12-01  
**Author:** Nhóm 7

---

## **1. Tổng quan**

Tài liệu này mô tả các luồng người dùng (User Flows) trong hệ thống Mini Banking System, bao gồm các bước chi tiết và các nhánh xử lý.

---

## **2. Authentication Flows**

### **2.1. Registration Flow**

```
Start
  │
  ├─→ [Register Page]
  │     │
  │     ├─→ User nhập thông tin
  │     │     ├─→ Email
  │     │     ├─→ Password
  │     │     ├─→ Confirm Password
  │     │     └─→ Full Name (optional)
  │     │
  │     ├─→ [Validation]
  │     │     ├─→ Email format valid? ──NO──→ Show error → Retry
  │     │     ├─→ Email unique? ──NO──→ Show error → Retry
  │     │     ├─→ Password strong? ──NO──→ Show error → Retry
  │     │     └─→ Passwords match? ──NO──→ Show error → Retry
  │     │
  │     ├─→ [Submit Form]
  │     │     │
  │     │     ├─→ API Call → Loading state
  │     │     │
  │     │     ├─→ Success
  │     │     │     ├─→ Show success toast
  │     │     │     └─→ Redirect to Login (2s delay)
  │     │     │
  │     │     └─→ Error
  │     │           ├─→ Show error message
  │     │           └─→ Stay on page
  │     │
  │     └─→ [Link: Already have account?]
  │           └─→ Navigate to Login
  │
End
```

### **2.2. Login Flow**

```
Start
  │
  ├─→ [Login Page]
  │     │
  │     ├─→ User nhập credentials
  │     │     ├─→ Email
  │     │     └─→ Password
  │     │
  │     ├─→ [Validation]
  │     │     ├─→ Email format valid? ──NO──→ Show error
  │     │     └─→ Password entered? ──NO──→ Disable button
  │     │
  │     ├─→ [Submit]
  │     │     │
  │     │     ├─→ API Call → Loading state
  │     │     │
  │     │     ├─→ Success
  │     │     │     ├─→ Store JWT token
  │     │     │     ├─→ Store user info
  │     │     │     └─→ Redirect to Dashboard
  │     │     │
  │     │     └─→ Error
  │     │           ├─→ INVALID_CREDENTIALS → Show error
  │     │           ├─→ ACCOUNT_LOCKED → Show error + contact admin
  │     │           └─→ ACCOUNT_FROZEN → Show error + unfreeze option
  │     │
  │     ├─→ [Link: Forgot Password?]
  │     │     └─→ Navigate to Forgot Password
  │     │
  │     └─→ [Link: Create Account]
  │           └─→ Navigate to Register
  │
End
```

### **2.3. Forgot Password Flow**

```
Start
  │
  ├─→ [Forgot Password Page]
  │     │
  │     ├─→ User nhập email
  │     │
  │     ├─→ [Validation]
  │     │     └─→ Email format valid? ──NO──→ Show error
  │     │
  │     ├─→ [Submit]
  │     │     │
  │     │     ├─→ API Call → Loading state
  │     │     │
  │     │     ├─→ Success
  │     │     │     ├─→ Show success message
  │     │     │     └─→ Redirect to Reset Password (with email param)
  │     │     │
  │     │     └─→ Error
  │     │           └─→ EMAIL_NOT_FOUND → Show error
  │     │
  │     └─→ [Link: Back to Login]
  │           └─→ Navigate to Login
  │
End
```

### **2.4. Reset Password Flow**

```
Start
  │
  ├─→ [Reset Password Page]
  │     │
  │     ├─→ User nhập OTP (6 digits)
  │     │     ├─→ Auto-focus next field
  │     │     └─→ Auto-submit when complete
  │     │
  │     ├─→ User nhập new password
  │     │
  │     ├─→ User confirm password
  │     │
  │     ├─→ [Validation]
  │     │     ├─→ OTP valid? ──NO──→ Show error
  │     │     ├─→ Password strong? ──NO──→ Show error
  │     │     └─→ Passwords match? ──NO──→ Show error
  │     │
  │     ├─→ [Submit]
  │     │     │
  │     │     ├─→ API Call → Loading state
  │     │     │
  │     │     ├─→ Success
  │     │     │     ├─→ Show success toast
  │     │     │     └─→ Redirect to Login
  │     │     │
  │     │     └─→ Error
  │     │           ├─→ INVALID_OTP → Show error
  │     │           ├─→ OTP_EXPIRED → Show error + resend option
  │     │           └─→ OTP_MAX_ATTEMPTS → Show error + contact support
  │     │
  │     └─→ [Link: Back to Login]
  │           └─→ Navigate to Login
  │
End
```

---

## **3. Transaction Flows**

### **3.1. Deposit Flow**

```
Start
  │
  ├─→ [Dashboard]
  │     │
  │     └─→ Click "Deposit" button
  │           │
  │           └─→ Navigate to Deposit Page
  │
  ├─→ [Deposit Page]
  │     │
  │     ├─→ Display current balance
  │     │
  │     ├─→ User nhập amount
  │     │     │
  │     │     ├─→ Real-time format (1,000,000)
  │     │     └─→ Calculate balance after deposit
  │     │
  │     ├─→ [Validation]
  │     │     ├─→ Amount > 0? ──NO──→ Show error
  │     │     └─→ Account ACTIVE? ──NO──→ Disable button + show error
  │     │
  │     ├─→ [Submit]
  │     │     │
  │     │     ├─→ Optional: Show confirmation modal
  │     │     │
  │     │     ├─→ API Call → Loading state
  │     │     │
  │     │     ├─→ Success
  │     │     │     ├─→ Show success toast
  │     │     │     ├─→ WebSocket update balance
  │     │     │     └─→ Redirect to Dashboard
  │     │     │
  │     │     └─→ Error
  │     │           ├─→ ACCOUNT_FROZEN → Show error
  │     │           ├─→ ACCOUNT_LOCKED → Show error
  │     │           └─→ INVALID_AMOUNT → Show error
  │     │
  │     └─→ [Back Button]
  │           └─→ Navigate to Dashboard
  │
End
```

### **3.2. Withdraw Flow**

```
Start
  │
  ├─→ [Dashboard]
  │     │
  │     └─→ Click "Withdraw" button
  │           │
  │           └─→ Navigate to Withdraw Page
  │
  ├─→ [Withdraw Page]
  │     │
  │     ├─→ Display current balance
  │     │
  │     ├─→ User nhập amount
  │     │     │
  │     │     ├─→ Real-time format
  │     │     └─→ Calculate balance after withdraw
  │     │           │
  │     │           └─→ Amount > Balance? ──YES──→ Show warning
  │     │
  │     ├─→ [Validation]
  │     │     ├─→ Amount > 0? ──NO──→ Show error
  │     │     ├─→ Amount <= Balance? ──NO──→ Show error
  │     │     └─→ Account ACTIVE? ──NO──→ Disable button + show error
  │     │
  │     ├─→ [Submit]
  │     │     │
  │     │     ├─→ Optional: Show confirmation modal
  │     │     │
  │     │     ├─→ API Call → Loading state
  │     │     │
  │     │     ├─→ Success
  │     │     │     ├─→ Show success toast
  │     │     │     ├─→ WebSocket update balance
  │     │     │     └─→ Redirect to Dashboard
  │     │     │
  │     │     └─→ Error
  │     │           ├─→ INSUFFICIENT_BALANCE → Show error
  │     │           ├─→ ACCOUNT_FROZEN → Show error
  │     │           └─→ ACCOUNT_LOCKED → Show error
  │     │
  │     └─→ [Back Button]
  │           └─→ Navigate to Dashboard
  │
End
```

### **3.3. Transfer Flow**

```
Start
  │
  ├─→ [Dashboard]
  │     │
  │     └─→ Click "Transfer" button
  │           │
  │           └─→ Navigate to Transfer Page
  │
  ├─→ [Transfer Page]
  │     │
  │     ├─→ Display current balance
  │     │
  │     ├─→ User nhập receiver account ID
  │     │     │
  │     │     ├─→ Validate UUID format
  │     │     └─→ Debounce check account exists (500ms)
  │     │           │
  │     │           ├─→ Account found → Show receiver info
  │     │           └─→ Account not found → Show error
  │     │
  │     ├─→ User nhập amount
  │     │     │
  │     │     └─→ Calculate balance after transfer
  │     │
  │     ├─→ [Validation]
  │     │     ├─→ Receiver account exists? ──NO──→ Show error
  │     │     ├─→ Receiver account ACTIVE/FROZEN? ──NO──→ Show error
  │     │     ├─→ Amount > 0? ──NO──→ Show error
  │     │     ├─→ Amount <= Balance? ──NO──→ Show error
  │     │     └─→ Sender account ACTIVE? ──NO──→ Show error
  │     │
  │     ├─→ [Submit]
  │     │     │
  │     │     ├─→ Show confirmation modal
  │     │     │     ├─→ Receiver account info
  │     │     │     ├─→ Amount
  │     │     │     └─→ Balance after
  │     │     │
  │     │     ├─→ User confirms
  │     │     │     │
  │     │     │     ├─→ API Call → Loading state
  │     │     │     │
  │     │     │     ├─→ Success
  │     │     │     │     ├─→ Show success toast với details
  │     │     │     │     ├─→ WebSocket update balance
  │     │     │     │     └─→ Redirect to Dashboard
  │     │     │     │
  │     │     │     └─→ Error
  │     │     │           ├─→ RECEIVER_ACCOUNT_NOT_FOUND → Show error
  │     │     │           ├─→ RECEIVER_ACCOUNT_LOCKED → Show error
  │     │     │           ├─→ INSUFFICIENT_BALANCE → Show error
  │     │     │           └─→ ACCOUNT_FROZEN → Show error
  │     │     │
  │     │     └─→ User cancels → Stay on page
  │     │
  │     └─→ [Back Button]
  │           └─→ Navigate to Dashboard
  │
End
```

---

## **4. Account Management Flows**

### **4.1. Self-Freeze Flow**

```
Start
  │
  ├─→ [Dashboard]
  │     │
  │     └─→ Click "Freeze Account" button
  │           │
  │           └─→ Navigate to Settings
  │
  ├─→ [Settings Page]
  │     │
  │     └─→ Click "Freeze Account" button (red)
  │           │
  │           └─→ Show confirmation modal
  │
  ├─→ [Confirmation Modal]
  │     │
  │     ├─→ Display warning message
  │     │
  │     ├─→ User nhập password
  │     │
  │     ├─→ [Validation]
  │     │     └─→ Password correct? ──NO──→ Show error
  │     │
  │     ├─→ [Submit]
  │     │     │
  │     │     ├─→ API Call → Loading state
  │     │     │
  │     │     ├─→ Success
  │     │     │     ├─→ Show success toast
  │     │     │     ├─→ Clear JWT token
  │     │     │     ├─→ Clear user info
  │     │     │     └─→ Redirect to Login
  │     │     │
  │     │     └─→ Error
  │     │           ├─→ INVALID_PASSWORD → Show error
  │     │           ├─→ ACCOUNT_ALREADY_FROZEN → Show error
  │     │           └─→ ACCOUNT_LOCKED → Show error
  │     │
  │     └─→ [Cancel Button]
  │           └─→ Close modal → Stay on Settings
  │
End
```

---

## **5. Transaction History Flow**

```
Start
  │
  ├─→ [Dashboard]
  │     │
  │     └─→ Click "Transaction History" button
  │           │
  │           └─→ Navigate to Transaction History Page
  │
  ├─→ [Transaction History Page]
  │     │
  │     ├─→ Load transactions (default: last 30 days)
  │     │     │
  │     │     └─→ Show loading skeleton
  │     │
  │     ├─→ Display transactions table
  │     │
  │     ├─→ [Filters]
  │     │     │
  │     │     ├─→ Select Type Filter
  │     │     │     └─→ Reload transactions
  │     │     │
  │     │     ├─→ Select Date Range
  │     │     │     └─→ Reload transactions
  │     │     │
  │     │     └─→ Search by Transaction ID
  │     │           └─→ Filter results
  │     │
  │     ├─→ [Sort]
  │     │     │
  │     │     └─→ Click column header → Sort transactions
  │     │
  │     ├─→ [Pagination]
  │     │     │
  │     │     ├─→ Click page number → Load page
  │     │     └─→ Click Next/Prev → Navigate pages
  │     │
  │     ├─→ [Empty State]
  │     │     │
  │     │     └─→ No transactions → Show empty state message
  │     │
  │     └─→ [Back Button]
  │           └─→ Navigate to Dashboard
  │
End
```

---

## **6. Admin Flows**

### **6.1. Admin Login Flow**

```
Start
  │
  ├─→ [Login Page]
  │     │
  │     └─→ Admin credentials
  │           │
  │           └─→ API Call
  │                 │
  │                 ├─→ Success + Admin role
  │                 │     │
  │                 │     └─→ Redirect to Admin Dashboard
  │                 │
  │                 └─→ Success + User role
  │                       │
  │                       └─→ Redirect to User Dashboard
  │
End
```

### **6.2. Admin User Management Flow**

```
Start
  │
  ├─→ [Admin Dashboard]
  │     │
  │     ├─→ View user list
  │     │
  │     ├─→ [Filters]
  │     │     │
  │     │     ├─→ Filter by status
  │     │     └─→ Search by email
  │     │
  │     ├─→ [Actions]
  │     │     │
  │     │     ├─→ Click "Lock" button
  │     │     │     │
  │     │     │     ├─→ Show confirmation modal
  │     │     │     │
  │     │     │     ├─→ Confirm → API Call
  │     │     │     │     │
  │     │     │     │     ├─→ Success → Update table
  │     │     │     │     └─→ Error → Show error
  │     │     │     │
  │     │     │     └─→ Cancel → Close modal
  │     │     │
  │     │     ├─→ Click "Unlock" button
  │     │     │     └─→ Similar flow
  │     │     │
  │     │     ├─→ Click "Freeze" button
  │     │     │     └─→ Similar flow
  │     │     │
  │     │     └─→ Click "Unfreeze" button
  │     │           └─→ Similar flow
  │     │
  │     └─→ [Pagination]
  │           └─→ Navigate pages
  │
End
```

---

## **7. Error Handling Flows**

### **7.1. Network Error Flow**

```
API Call
  │
  ├─→ Network Error
  │     │
  │     ├─→ Show error toast
  │     │
  │     ├─→ Retry button (optional)
  │     │     │
  │     │     └─→ Retry API call
  │     │
  │     └─→ Keep current state
  │
End
```

### **7.2. Session Expired Flow**

```
API Call
  │
  ├─→ 401 Unauthorized (Token expired)
  │     │
  │     ├─→ Clear JWT token
  │     │
  │     ├─→ Clear user info
  │     │
  │     ├─→ Show session expired message
  │     │
  │     └─→ Redirect to Login
  │
End
```

---

## **8. Real-time Updates Flow**

```
WebSocket Connection
  │
  ├─→ Connected
  │     │
  │     ├─→ Listen for events
  │     │
  │     ├─→ TRANSACTION_COMPLETED event
  │     │     │
  │     │     ├─→ Update balance (if on Dashboard)
  │     │     │
  │     │     └─→ Show toast notification
  │     │
  │     └─→ ACCOUNT_STATUS_CHANGED event
  │           │
  │           └─→ Update account status badge
  │
  ├─→ Disconnected
  │     │
  │     └─→ Attempt reconnect (exponential backoff)
  │
End
```

---

## **9. Navigation Flow Map**

```
┌─────────────┐
│   Login     │
└──────┬──────┘
       │
       ├─→ Register
       │     └─→ Login
       │
       ├─→ Forgot Password
       │     └─→ Reset Password
       │           └─→ Login
       │
       └─→ Dashboard (after login)
             │
             ├─→ Deposit
             │     └─→ Dashboard
             │
             ├─→ Withdraw
             │     └─→ Dashboard
             │
             ├─→ Transfer
             │     └─→ Dashboard
             │
             ├─→ Transaction History
             │     └─→ Dashboard
             │
             └─→ Settings
                   └─→ Dashboard

Admin Flow:
Login (admin) → Admin Dashboard
                ├─→ User Management
                └─→ Reports
```

---

**Lưu ý:** Tất cả các flows phải xử lý error cases và loading states một cách nhất quán.

